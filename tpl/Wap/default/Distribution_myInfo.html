<!DOCTYPE html>
<html>
<head>
<title>用户中心-我的资料</title>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="stylesheet" href="{pigcms::RES}/distri/css/jquery.mobile-1.3.2.min.css">
<script src="{pigcms::RES}/distri/js/jquery-1.8.3.min.js"></script>
<script src="{pigcms::RES}/distri/js/jquery.mobile-1.3.2.min.js"></script>
<script src="{pigcms::STATICS}/vote/wap/jquery.icheck.min.js?v=0.9.1"></script>
<style>
.ui-content{padding:0}
.ui-btn{text-align:left}
.header{display:-webkit-box;-webkit-box-align:center;}
.header img{width:25%;display:block}
.header div{padding-left:5%;font-size:16px;line-height:30px;font-weight:bold}
.middleShow{display:-webkit-box;text-align:center;height:50px;line-height:50px;color:#fff;}
.middleShow span{display:block;background:url(http://www.xiaomiguzi.com/bg2014.jpg) repeat;width:50%;}
.middleShow span.leftInfo{border-right:1px #fff solid;border-top:1px #fff solid}
.middleShow span.rightInfo{border-top:1px #fff solid}
input{text-align:center}
.deploy_ctype_tip{z-index:1001;width:100%;text-align:center;position:fixed;top:50%;margin-top:-23px;left:0;}.deploy_ctype_tip p{display:inline-block;padding:13px 24px;border:solid #d6d482 1px;background:#f5f4c5;font-size:16px;color:#8f772f;line-height:18px;border-radius:3px;}
</style>
</head>
<body >

<div data-role="page" id="pageone" style="background:#fff4a7">
  <div data-role="content" data-theme="e">
   <div style="padding:10px 20px;text-align:center">
		<div data-role="fieldcontain" style="line-height:60px;border:1px #f4c63f solid;-moz-border-radius:5px;-webkit-border-radius:5px;border-radius:5px;padding:5px;background:#fff">
			<label for="name" style="line-height:60px;">真实姓名：</label>
			<input type="text" name="name" value="{pigcms:$my.name}" id="name" placeholder="请输入您的真实姓名..">
			<!--fieldset data-role="controlgroup" style="text-align:right">
				<label for="male" style="line-height:15px;">男性</label>
				<input type="radio" name="sex"  id="male" value="男" <eq name="my.sex" value="男">checked</eq>>
				<label for="female" style="line-height:15px;">女性</label>
				<input type="radio" name="sex" id="female" value="女" <eq name="my.sex" value="女">checked</eq>>	
			  </fieldset-->
			<label for="tele" style="line-height:60px;">手机号码：</label>
			<input type="text" name="tele" id="tele" value="{pigcms:$my.tele}" placeholder="请输入您的手机号码..">
			<label for="tele" style="line-height:60px;">QQ号码：</label>
			<input type="email" name="email" id="email" value="{pigcms:$my.email}" placeholder="请输入您的QQ号码..">
		</div>
		<br/>
		<a href="javascript:void(0)" data-role="button" id="pxbtn" style="text-align:center;width:60%;margin:0 auto;">保存</a>
		<br/>
		<a href="{pigcms::U('Distribution/myBank',array('token'=>$token,'wecha_id'=>$wecha_id))}" data-role="button" data-icon="arrow-r" rel="external" data-iconpos="right">我的银行卡</a>
   </div>
  </div>
</div> 
<script>
function onBridgeReady(){
 WeixinJSBridge.call('hideOptionMenu');
}

if (typeof WeixinJSBridge == "undefined"){
    if( document.addEventListener ){
        document.addEventListener('WeixinJSBridgeReady', onBridgeReady, false);
    }else if (document.attachEvent){
        document.attachEvent('WeixinJSBridgeReady', onBridgeReady); 
        document.attachEvent('onWeixinJSBridgeReady', onBridgeReady);
    }
}else{
    onBridgeReady();
}
</script>
	<script>
                    $(document).ready(function() {

					 $("#pxbtn").bind("click",
                        function() {

                            var self = $(this);
							var wecha_id = "{pigcms:$wecha_id}";
                            var name = $('#name').val();
                            //var sex=$("input[name='sex']:checked").val();
                            var tele = $('#tele').val();
                            var email = $('#email').val();

                            if (wecha_id == '') {

                                showTip("异常的访问链接");

                                return;

                            }
							if(name==''){
								showTip("姓名不能为空");

                                return;
							}
							/*if(sex==''){
								showTip("请选择性别");

                                return;
							}*/
							if(tele==''){
								showTip("手机号码不能为空");

                                return;
							}
							if(email==''){
								showTip("QQ号码不能为空");

                                return;
							}
							var submitData = {
								name: name,
								//sex: sex,
								tele: tele,
								email: email
							};

							$.post("{pigcms::U('Distribution/myInfo',array('token'=>$token,'wecha_id'=>$wecha_id))}", submitData,
							function(bakcdata) {
								var obj = eval('(' + bakcdata + ')');

								if (obj.success == 1) {

									showTip(obj.info);
									setTimeout("window.location.href='{pigcms::U('Distribution/myInfo',array('token'=>$token,'wecha_id'=>$wecha_id))}'", 2000);

									return

								} else {

									showTip(obj.info);

									return

								}

							});

                        });
                    });
					function showTip(tipTxt) {
					  var div = document.createElement('div');
					  div.innerHTML = '<div class="deploy_ctype_tip"><p>' + tipTxt + '</p></div>';
					  var tipNode = div.firstChild;
					  $("#pageone").after(tipNode);
					  setTimeout(function () {
						$(tipNode).remove();
					  }, 1500);
					}
                </script>
</body>
</html>