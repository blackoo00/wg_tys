<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
    <meta content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no" name="viewport">
    <meta content="application/xhtml+xml;charset=UTF-8" http-equiv="Content-Type">
    <meta content="telephone=no, address=no" name="format-detection">
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <link href="{wghd::RES}/bsuger/Content/comm/css/weixin.css" rel="stylesheet" />
    <script src="{wghd::RES}/bsuger/Content/comm/js/jquery-1.7.1.min.js"></script>
    <script src="{wghd::RES}/bsuger/Areas/LWeChat/Scripts/jquery.unobtrusive-ajax.js"></script>
    <script src="{wghd::RES}/bsuger/Areas/LWeChat/Scripts/jquery.validate.js"></script>
    <script src="{wghd::RES}/bsuger/Areas/LWeChat/Scripts/jquery.validate.unobtrusive.js"></script>

    <script src="{wghd::RES}/bsuger/Scripts/base.js"></script>
    <script>
        function Begin() {
            // $.ajax({
            //     url:url,
            //     data:{id:'test'},
            //     success:function(data){
            //         console.log(data);
            //     }
            // })
            $("#TimeSlice").val($('#timeareab').val());
            $("#RecordTime").val($('#now').val());
            $("#Number").val($('#mod_val').html());
        }
    </script>

    <link href="{wghd::RES}/bsuger/Content/css/diabetes.css" rel="stylesheet" />
    <title></title>
    <style type="text/css">
        .android-ics .dww .dw-li
        {
            font-size: 12px;
        }
        .medicine{width: 100%;border:solid #add9c0; border-width:1px 0px 0px 1px;}
        .medicine th,.medicine td{border:solid #add9c0; border-width:0px 1px 1px 0px; height: 30px;}
        .medicine td{text-align: center; font-size: 1.3em;}
    </style>
</head>
<body class="index">
    <div class="ol">
<form action="{wghd::U('Steward/bsuger',array('token'=>$token,'wecha_id'=>$wecha_id))}" data-ajax="true" data-ajax-begin="Begin" data-ajax-method="Post" data-ajax-success="OnSuccess" id="form0" method="post">    
            <div class="pagetitle ul">
                <div class="f1">血糖记录</div>
            </div>
            <article class="f1  bc1">
                <section class="record " style="padding-top: 10px;">
                    <dl>
                        <dt class="ul">
                            <div class="title ">血糖值：</div>
                            <div class="f1 title2"><span id="mod_val">7</span><i class="danwei">mmol/L</i></div>
                            <input data-val="true" data-val-number="字段 血糖 必须是一个数字。" data-val-required="The 血糖 field is required." id="Number" name="Number" type="hidden" value="" />
                        </dt>
                        <dd>
                            <div class="input">
                                <div class="mol_box">
                                    <div class="mol" style="height: 43px">
                                        <div id="mol_wrapper">
                                            <div id="mol_scroller">
                                                <ul class="ul1" style="background: url('http://weixin.joinhead.com/Uploadfile/hzzhit/image/20150325/20150325164646_0643.png'); width: 100%; background-repeat: no-repeat; background-position: -4px 0;">
                                                </ul>

                                            </div>
                                        </div>
                                        <div class="index"></div>
                                    </div>
                                </div>
                            </div>
                        </dd>
                    </dl>
                    <dl>
                        <dt class="ul">
                            <div class="title">测量时段：</div>
                            <div class="f1 title2 sel_f">
                                <input type="hidden" id="timeareab" value="kf">
                                <span id="timearea">空腹</span>
                                <select name="timearea">
                                    <option value="kf">空腹</option>
                                    <option value="zchtxs">早餐后2小时</option>
                                    <option value="acq">午餐前</option>
                                    <option value="achtxs">午餐后2小时</option>
                                    <option value="wcq">晚餐前</option>
                                    <option value="wchtxs">晚餐后2小时</option>
                                    <option value="sq">睡前</option>
                                    <option value="lctxs">凌晨3小时</option>
                                </select>
                                <input id="TimeSlice" name="TimeSlice" type="hidden" value="" />
                            </div>
                        </dt>
                        <dt class="ul">
                            <div class="title">测量时间：</div>
                            <div class="f1 title2">
                                
                                <input type="text" class="f1" id="now" />
                                <input data-val="true" data-val-date="字段 记录时间 必须是日期。" data-val-required="The 记录时间 field is required." id="RecordTime" name="RecordTime" type="hidden" value="" />
                            </div>
                        </dt>
                    </dl>
                </section>
            </article>
            <section class="sure_box">
                <button class="sure" onclick="Begin();">保存</button>
            </section>
</form> 
<div class="pagetitle ul">
    <div class="f1">血糖详情</div>
</div>
<section>
    <style>
        .bloodsuger{width: 100%; border:solid #add9c0; border-width:1px 0px 0px 1px; margin-top: 5px;}
        .bloodsuger th,.bloodsuger td{border:solid #add9c0; border-width:0px 1px 1px 0px; height: 30px;}
        .bloodsuger td{text-align: center;}
        .xtjl{color:red;}
    </style>
    <table class="bloodsuger">
        <tr>
            <td rowspan="2">日期</td>
            <td></td>
            <td colspan="2">早餐</td>
            <td colspan="2">午餐</td>
            <td colspan="2">晚餐</td>
            <td></td>
        </tr>
        <tr>
            <td>凌晨</td>
            <td>空腹</td>
            <td>餐后</td>
            <td>餐前</td>
            <td>餐后</td>
            <td>餐前</td>
            <td>餐后</td>
            <td>睡前</td>
        </tr>
        <volist id="list" name="bsuger">
            <tr>
                <td class="xtjl">{wghd:$list.recordtime|friendlyDate=###,md,false}</td>
                <td class="xtjl">{wghd:$list.lctxs}</td>
                <td class="xtjl">{wghd:$list.kf}</td>
                <td class="xtjl">{wghd:$list.zchtxs}</td>
                <td class="xtjl">{wghd:$list.acq}</td>
                <td class="xtjl">{wghd:$list.achtxs}</td>
                <td class="xtjl">{wghd:$list.wcq}</td>
                <td class="xtjl">{wghd:$list.wchtxs}</td>
                <td class="xtjl">{wghd:$list.sq}</td>
            </tr>
        </volist>
    </table>
    <a href="#" id="loadmore" style="display:block; margin:5px auto; text-align:center; color:red">点击加载更多</a>
    <script>
        $(function(){
            $("#loadmore").bind("click",function(event){
                event.preventDefault();
                var trnums=$('.bloodsuger tr').length-2;
                $.ajax({
                    url:"{wghd::U('Steward/loadmorebsuger',array('token'=>$token,'wecha_id'=>$wecha_id))}",
                    data:{trnums:trnums},
                    success:function(data){
                        if(data=="error"){
                            alert("没有更多数据");
                        }else{
                            $(".bloodsuger").append(data);
                        }
                    }
                })
            })
        })
    </script>
</section>
<!-- <section class="height-chart">
    <div id="container" style="min-width: 310px; height: 400px; margin: 0 auto"></div>
</section> -->
</div>
<include file="Public:support"/>
</body>

<script src="{wghd::RES}/bsuger/Content/comm/js/iscroll.js"></script>
<script src="http://cdn.hcharts.cn/highcharts/4.0.3/highcharts.js"></script>

<script src="{wghd::RES}/bsuger/Content/comm/js/timeformat.js"></script>
<script>
    //滑块
    var myScroll;
    $(function () {
        var mol_wrapper_w = $('#mol_wrapper').width();
        var blank_width = mol_wrapper_w / 2 / 10;
        var mol_wrapper_w = $('#mol_wrapper').width();
        var blank_width = mol_wrapper_w / 2 / 10;
        $('#mol_scroller').width(4017 + mol_wrapper_w + 2);
        $('#mol_scroller .ul1').css('background-position', mol_wrapper_w / 2 + 'px' + ' 0');


        //指针初始位置
        $('.mol_box .index').css({ left: mol_wrapper_w / 2 + 2 });


        //var myScroll;
        function loaded() {
            myScroll = new IScroll('#mol_wrapper', { scrollX: true, scrollY: false, mouseWheel: true, startX: -700 });

        }

        loaded();

        setInterval(function () {
            $('#mod_val').html(-1 * (myScroll.x / 100));


        }, 100);


        //document.addEventListener('touchmove', function (e) { e.preventDefault(); }, false);
    });
</script>
<script>
    $(function () {
        //当前时间
        var now = new Date();
        $('#now').val(now.format("yyyy-MM-dd hh:mm"));




    });
</script>

<script>
    $(function () {

        $('[name=timearea]').change(function () {
            $('#timearea').html($('[name=timearea] option:selected').text());
            $('#timeareab').val($('[name=timearea] option:selected').val());
        });
    });
</script>


<script src="{wghd::RES}/bsuger/Content/comm/js/mobiscroll.core-2.5.2.js" type="text/javascript"></script>
<script src="{wghd::RES}/bsuger/Content/comm/js/mobiscroll.core-2.5.2-zh.js" type="text/javascript"></script>
<link href="{wghd::RES}/bsuger/Content/comm/css/mobiscroll.core-2.5.2.css" rel="stylesheet" type="text/css">
<link href="{wghd::RES}/bsuger/Content/comm/css/mobiscroll.animation-2.5.2.css" rel="stylesheet" type="text/css">
<script src="{wghd::RES}/bsuger/Content/comm/js/mobiscroll.datetime-2.5.1.js" type="text/javascript"></script>
<script src="{wghd::RES}/bsuger/Content/comm/js/mobiscroll.datetime-2.5.1-zh.js" type="text/javascript"></script>

<!-- S 可根据自己喜好引入样式风格文件 -->
<script src="{wghd::RES}/bsuger/Content/comm/js/mobiscroll.android-ics-2.5.2.js" type="text/javascript"></script>
<link href="{wghd::RES}/bsuger/Content/comm/css/mobiscroll.android-ics-2.5.2.css" rel="stylesheet" type="text/css">
<!-- E 可根据自己喜好引入样式风格文件 -->
<script type="text/javascript">
    $(function () {
        var currYear = (new Date()).getFullYear();
        var opt = {};
        opt.date = { preset: 'date' };
        opt.datetime = { preset: 'datetime', maxDate: new Date(), width: 36 };
        opt.time = { preset: 'time' };
        opt.default = {
            theme: 'android-ics light', //皮肤样式
            display: 'modal', //显示方式 
            mode: 'scroller', //日期选择模式
            lang: 'zh',
            startYear: currYear - 1, //开始年份
            endYear: currYear + 1 //结束年份
        };

        var optDateTime = $.extend(opt['datetime'], opt['default']);
        var optTime = $.extend(opt['time'], opt['default']);
        $("#now").mobiscroll(optDateTime).datetime(optDateTime);

    });
</script>
</html>


